{"ast":null,"code":"var _jsxFileName = \"D:\\\\BE COMP SS\\\\Final Year Project\\\\5\\\\land2\\\\land2\\\\client\\\\src\\\\views\\\\MakePayment.js\";\nimport { LoadingContainer } from '@drizzle/react-components';\nimport { DrizzleProvider } from '@drizzle/react-plugin';\nimport React, { Component } from \"react\";\nimport { Spinner } from 'react-bootstrap'; // reactstrap components\n\nimport { Button, Card, CardBody, CardHeader, CardTitle, Col, Row, Table } from \"reactstrap\";\nimport '../../node_modules/bootstrap/dist/css/bootstrap.min.css';\nimport Land from \"../artifacts/Land.json\";\nimport getWeb3 from \"../getWeb3\";\nimport \"../index.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst drizzleOptions = {\n  contracts: [Land]\n};\nvar row = [];\nvar landOwner = [];\n\nclass Dashboard extends Component {\n  constructor(props) {\n    super(props);\n\n    this.makePayment = (seller_address, amount, land_id) => async () => {\n      // alert(amount);\n      amount = amount * 0.0000057;\n      alert(amount);\n      await this.state.LandInstance.methods.payment(seller_address, land_id).send({\n        from: this.state.account,\n        value: this.state.web3.utils.toWei(amount.toString(), \"ether\"),\n        gas: 2100000\n      }).then(response => {\n        this.props.history.push(\"#\");\n      }); //Reload\n\n      window.location.reload(false);\n    };\n\n    this.componentDidMount = async () => {\n      //For refreshing page only once\n      if (!window.location.hash) {\n        console.log(window.location.hash);\n        window.location = window.location + '#loaded';\n        window.location.reload();\n      }\n\n      try {\n        //Get network provider and web3 instance\n        const web3 = await getWeb3();\n        const accounts = await web3.eth.getAccounts();\n        const networkId = await web3.eth.net.getId();\n        const deployedNetwork = Land.networks[networkId];\n        const instance = new web3.eth.Contract(Land.abi, deployedNetwork && deployedNetwork.address);\n        this.setState({\n          LandInstance: instance,\n          web3: web3,\n          account: accounts[0]\n        });\n        const currentAddress = await web3.currentProvider.selectedAddress;\n        console.log(currentAddress);\n        var registered = await this.state.LandInstance.methods.isBuyer(currentAddress).call();\n        console.log(registered);\n        this.setState({\n          registered: registered\n        });\n        var count = await this.state.LandInstance.methods.getLandsCount().call();\n        count = parseInt(count);\n        console.log(typeof count);\n        console.log(count);\n        var dict = {};\n\n        for (var i = 1; i < count + 1; i++) {\n          var address = await this.state.LandInstance.methods.getLandOwner(i).call();\n          dict[i] = address;\n        }\n\n        for (i = 0; i < count; i++) {\n          var paid = await this.state.LandInstance.methods.isPaid(i + 1).call();\n          var price = await this.state.LandInstance.methods.getPrice(i + 1).call();\n          row.push( /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"td\", {\n              children: i + 1\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 104,\n              columnNumber: 22\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: dict[i + 1]\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 104,\n              columnNumber: 38\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: price\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 104,\n              columnNumber: 60\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                onClick: this.makePayment(dict[i + 1], price, i + 1),\n                disabled: paid,\n                className: \"btn btn-success\",\n                children: \"Make Payment\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 106,\n                columnNumber: 13\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 105,\n              columnNumber: 11\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 18\n          }, this));\n        }\n\n        console.log(row);\n      } catch (error) {\n        // Catch any errors for any of the above operations.\n        alert(`Failed to load web3, accounts, or contract. Check console for details.`);\n        console.error(error);\n      }\n    };\n\n    this.state = {\n      LandInstance: undefined,\n      account: null,\n      web3: null,\n      count: 0,\n      requested: false\n    };\n  }\n\n  render() {\n    if (!this.state.web3) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"h1\", {\n            children: /*#__PURE__*/_jsxDEV(Spinner, {\n              animation: \"border\",\n              variant: \"primary\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 136,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 9\n      }, this);\n    }\n\n    if (!this.state.registered) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"content\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(Row, {\n            children: /*#__PURE__*/_jsxDEV(Col, {\n              xs: \"6\",\n              children: /*#__PURE__*/_jsxDEV(Card, {\n                className: \"card-chart\",\n                children: /*#__PURE__*/_jsxDEV(CardBody, {\n                  children: /*#__PURE__*/_jsxDEV(\"h1\", {\n                    children: \"You are not verified to view this page\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 152,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 151,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 150,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 149,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 9\n      }, this);\n    }\n\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"content\",\n        children: /*#__PURE__*/_jsxDEV(DrizzleProvider, {\n          options: drizzleOptions,\n          children: /*#__PURE__*/_jsxDEV(LoadingContainer, {\n            children: /*#__PURE__*/_jsxDEV(Row, {\n              children: /*#__PURE__*/_jsxDEV(Col, {\n                lg: \"12\",\n                md: \"12\",\n                children: /*#__PURE__*/_jsxDEV(Card, {\n                  children: [/*#__PURE__*/_jsxDEV(CardHeader, {\n                    children: /*#__PURE__*/_jsxDEV(CardTitle, {\n                      tag: \"h4\",\n                      children: [\"Payment for Lands\", /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"duration\",\n                        children: \"\\u20B9 1 = 0.0000057 Ether\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 174,\n                        columnNumber: 60\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 174,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 173,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(CardBody, {\n                    children: /*#__PURE__*/_jsxDEV(Table, {\n                      className: \"tablesorter\",\n                      responsive: true,\n                      color: \"black\",\n                      children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n                        className: \"text-primary\",\n                        children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                          children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                            children: \"#\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 181,\n                            columnNumber: 29\n                          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                            children: \"Land Owner\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 182,\n                            columnNumber: 29\n                          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                            children: \"Price ( in rupees )\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 183,\n                            columnNumber: 29\n                          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                            children: \"Make Payment\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 184,\n                            columnNumber: 29\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 180,\n                          columnNumber: 27\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 179,\n                        columnNumber: 25\n                      }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                        children: row\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 187,\n                        columnNumber: 25\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 178,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 177,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 172,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 171,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 170,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 9\n      }, this)\n    }, void 0, false);\n  }\n\n}\n\nexport default Dashboard;","map":{"version":3,"sources":["D:/BE COMP SS/Final Year Project/5/land2/land2/client/src/views/MakePayment.js"],"names":["LoadingContainer","DrizzleProvider","React","Component","Spinner","Button","Card","CardBody","CardHeader","CardTitle","Col","Row","Table","Land","getWeb3","drizzleOptions","contracts","row","landOwner","Dashboard","constructor","props","makePayment","seller_address","amount","land_id","alert","state","LandInstance","methods","payment","send","from","account","value","web3","utils","toWei","toString","gas","then","response","history","push","window","location","reload","componentDidMount","hash","console","log","accounts","eth","getAccounts","networkId","net","getId","deployedNetwork","networks","instance","Contract","abi","address","setState","currentAddress","currentProvider","selectedAddress","registered","isBuyer","call","count","getLandsCount","parseInt","dict","i","getLandOwner","paid","isPaid","price","getPrice","error","undefined","requested","render"],"mappings":";AAAA,SACEA,gBADF,QAEO,2BAFP;AAGA,SAASC,eAAT,QAAgC,uBAAhC;AACA,OAAOC,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,OAAT,QAAwB,iBAAxB,C,CACA;;AACA,SACEC,MADF,EACUC,IADV,EACgBC,QADhB,EAC0BC,UAD1B,EACsCC,SADtC,EACiDC,GADjD,EACsDC,GADtD,EAC2DC,KAD3D,QAEO,YAFP;AAGA,OAAO,yDAAP;AACA,OAAOC,IAAP,MAAiB,wBAAjB;AACA,OAAOC,OAAP,MAAoB,YAApB;AACA,OAAO,cAAP;;;AAIA,MAAMC,cAAc,GAAG;AACrBC,EAAAA,SAAS,EAAE,CAACH,IAAD;AADU,CAAvB;AAKA,IAAII,GAAG,GAAG,EAAV;AACA,IAAIC,SAAS,GAAG,EAAhB;;AAEA,MAAMC,SAAN,SAAwBhB,SAAxB,CAAkC;AAChCiB,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;;AADiB,SAanBC,WAbmB,GAaL,CAACC,cAAD,EAAiBC,MAAjB,EAAyBC,OAAzB,KAAqC,YAAY;AAC7D;AAEAD,MAAAA,MAAM,GAAGA,MAAM,GAAG,SAAlB;AACAE,MAAAA,KAAK,CAACF,MAAD,CAAL;AACA,YAAM,KAAKG,KAAL,CAAWC,YAAX,CAAwBC,OAAxB,CAAgCC,OAAhC,CACJP,cADI,EAEJE,OAFI,EAGJM,IAHI,CAGC;AACLC,QAAAA,IAAI,EAAE,KAAKL,KAAL,CAAWM,OADZ;AAELC,QAAAA,KAAK,EAAE,KAAKP,KAAL,CAAWQ,IAAX,CAAgBC,KAAhB,CAAsBC,KAAtB,CAA4Bb,MAAM,CAACc,QAAP,EAA5B,EAA+C,OAA/C,CAFF;AAGLC,QAAAA,GAAG,EAAE;AAHA,OAHD,EAOHC,IAPG,CAOEC,QAAQ,IAAI;AAClB,aAAKpB,KAAL,CAAWqB,OAAX,CAAmBC,IAAnB,CAAwB,GAAxB;AACD,OATK,CAAN,CAL6D,CAe7D;;AACAC,MAAAA,MAAM,CAACC,QAAP,CAAgBC,MAAhB,CAAuB,KAAvB;AAED,KA/BkB;;AAAA,SAiCnBC,iBAjCmB,GAiCC,YAAY;AAC9B;AACA,UAAI,CAACH,MAAM,CAACC,QAAP,CAAgBG,IAArB,EAA2B;AACzBC,QAAAA,OAAO,CAACC,GAAR,CAAYN,MAAM,CAACC,QAAP,CAAgBG,IAA5B;AACAJ,QAAAA,MAAM,CAACC,QAAP,GAAkBD,MAAM,CAACC,QAAP,GAAkB,SAApC;AACAD,QAAAA,MAAM,CAACC,QAAP,CAAgBC,MAAhB;AACD;;AAED,UAAI;AACF;AACA,cAAMX,IAAI,GAAG,MAAMrB,OAAO,EAA1B;AAEA,cAAMqC,QAAQ,GAAG,MAAMhB,IAAI,CAACiB,GAAL,CAASC,WAAT,EAAvB;AAEA,cAAMC,SAAS,GAAG,MAAMnB,IAAI,CAACiB,GAAL,CAASG,GAAT,CAAaC,KAAb,EAAxB;AACA,cAAMC,eAAe,GAAG5C,IAAI,CAAC6C,QAAL,CAAcJ,SAAd,CAAxB;AACA,cAAMK,QAAQ,GAAG,IAAIxB,IAAI,CAACiB,GAAL,CAASQ,QAAb,CACf/C,IAAI,CAACgD,GADU,EAEfJ,eAAe,IAAIA,eAAe,CAACK,OAFpB,CAAjB;AAKA,aAAKC,QAAL,CAAc;AAAEnC,UAAAA,YAAY,EAAE+B,QAAhB;AAA0BxB,UAAAA,IAAI,EAAEA,IAAhC;AAAsCF,UAAAA,OAAO,EAAEkB,QAAQ,CAAC,CAAD;AAAvD,SAAd;AAEA,cAAMa,cAAc,GAAG,MAAM7B,IAAI,CAAC8B,eAAL,CAAqBC,eAAlD;AACAjB,QAAAA,OAAO,CAACC,GAAR,CAAYc,cAAZ;AACA,YAAIG,UAAU,GAAG,MAAM,KAAKxC,KAAL,CAAWC,YAAX,CAAwBC,OAAxB,CAAgCuC,OAAhC,CAAwCJ,cAAxC,EAAwDK,IAAxD,EAAvB;AACApB,QAAAA,OAAO,CAACC,GAAR,CAAYiB,UAAZ;AACA,aAAKJ,QAAL,CAAc;AAAEI,UAAAA,UAAU,EAAEA;AAAd,SAAd;AACA,YAAIG,KAAK,GAAG,MAAM,KAAK3C,KAAL,CAAWC,YAAX,CAAwBC,OAAxB,CAAgC0C,aAAhC,GAAgDF,IAAhD,EAAlB;AACAC,QAAAA,KAAK,GAAGE,QAAQ,CAACF,KAAD,CAAhB;AACArB,QAAAA,OAAO,CAACC,GAAR,CAAY,OAAQoB,KAApB;AACArB,QAAAA,OAAO,CAACC,GAAR,CAAYoB,KAAZ;AAIA,YAAIG,IAAI,GAAG,EAAX;;AACA,aAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGJ,KAAK,GAAG,CAA5B,EAA+BI,CAAC,EAAhC,EAAoC;AAClC,cAAIZ,OAAO,GAAG,MAAM,KAAKnC,KAAL,CAAWC,YAAX,CAAwBC,OAAxB,CAAgC8C,YAAhC,CAA6CD,CAA7C,EAAgDL,IAAhD,EAApB;AACAI,UAAAA,IAAI,CAACC,CAAD,CAAJ,GAAUZ,OAAV;AACD;;AAED,aAAMY,CAAC,GAAG,CAAV,EAAaA,CAAC,GAAGJ,KAAjB,EAAwBI,CAAC,EAAzB,EAA6B;AAC3B,cAAIE,IAAI,GAAG,MAAM,KAAKjD,KAAL,CAAWC,YAAX,CAAwBC,OAAxB,CAAgCgD,MAAhC,CAAuCH,CAAC,GAAG,CAA3C,EAA8CL,IAA9C,EAAjB;AACA,cAAIS,KAAK,GAAG,MAAM,KAAKnD,KAAL,CAAWC,YAAX,CAAwBC,OAAxB,CAAgCkD,QAAhC,CAAyCL,CAAC,GAAG,CAA7C,EAAgDL,IAAhD,EAAlB;AACApD,UAAAA,GAAG,CAAC0B,IAAJ,eAAS;AAAA,oCAAI;AAAA,wBAAK+B,CAAC,GAAG;AAAT;AAAA;AAAA;AAAA;AAAA,oBAAJ,eAAoB;AAAA,wBAAKD,IAAI,CAACC,CAAC,GAAG,CAAL;AAAT;AAAA;AAAA;AAAA;AAAA,oBAApB,eAA0C;AAAA,wBAAKI;AAAL;AAAA;AAAA;AAAA;AAAA,oBAA1C,eACP;AAAA,qCACE,QAAC,MAAD;AAAQ,gBAAA,OAAO,EAAE,KAAKxD,WAAL,CAAiBmD,IAAI,CAACC,CAAC,GAAG,CAAL,CAArB,EAA8BI,KAA9B,EAAqCJ,CAAC,GAAG,CAAzC,CAAjB;AACE,gBAAA,QAAQ,EAAEE,IADZ;AACkB,gBAAA,SAAS,EAAC,iBAD5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,oBADO;AAAA;AAAA;AAAA;AAAA;AAAA,kBAAT;AASD;;AACD3B,QAAAA,OAAO,CAACC,GAAR,CAAYjC,GAAZ;AAKD,OAnDD,CAmDE,OAAO+D,KAAP,EAAc;AACd;AACAtD,QAAAA,KAAK,CACF,wEADE,CAAL;AAGAuB,QAAAA,OAAO,CAAC+B,KAAR,CAAcA,KAAd;AACD;AACF,KAnGkB;;AAGjB,SAAKrD,KAAL,GAAa;AACXC,MAAAA,YAAY,EAAEqD,SADH;AAEXhD,MAAAA,OAAO,EAAE,IAFE;AAGXE,MAAAA,IAAI,EAAE,IAHK;AAIXmC,MAAAA,KAAK,EAAE,CAJI;AAKXY,MAAAA,SAAS,EAAE;AALA,KAAb;AAOD;;AA6FDC,EAAAA,MAAM,GAAG;AACP,QAAI,CAAC,KAAKxD,KAAL,CAAWQ,IAAhB,EAAsB;AACpB,0BACE;AAAA,+BACE;AAAA,iCACE;AAAA,mCACE,QAAC,OAAD;AAAS,cAAA,SAAS,EAAC,QAAnB;AAA4B,cAAA,OAAO,EAAC;AAApC;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cADF;AAUD;;AAED,QAAI,CAAC,KAAKR,KAAL,CAAWwC,UAAhB,EAA4B;AAC1B,0BACE;AAAK,QAAA,SAAS,EAAC,SAAf;AAAA,+BACE;AAAA,iCACE,QAAC,GAAD;AAAA,mCACE,QAAC,GAAD;AAAK,cAAA,EAAE,EAAC,GAAR;AAAA,qCACE,QAAC,IAAD;AAAM,gBAAA,SAAS,EAAC,YAAhB;AAAA,uCACE,QAAC,QAAD;AAAA,yCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cADF;AAkBD;;AAED,wBACE;AAAA,6BACE;AAAK,QAAA,SAAS,EAAC,SAAf;AAAA,+BACE,QAAC,eAAD;AAAiB,UAAA,OAAO,EAAEpD,cAA1B;AAAA,iCACE,QAAC,gBAAD;AAAA,mCACE,QAAC,GAAD;AAAA,qCACE,QAAC,GAAD;AAAK,gBAAA,EAAE,EAAC,IAAR;AAAa,gBAAA,EAAE,EAAC,IAAhB;AAAA,uCACE,QAAC,IAAD;AAAA,0CACE,QAAC,UAAD;AAAA,2CACE,QAAC,SAAD;AAAW,sBAAA,GAAG,EAAC,IAAf;AAAA,mEAAqC;AAAM,wBAAA,SAAS,EAAC,UAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8BAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,0BADF,eAKE,QAAC,QAAD;AAAA,2CACE,QAAC,KAAD;AAAO,sBAAA,SAAS,EAAC,aAAjB;AAA+B,sBAAA,UAAU,MAAzC;AAA0C,sBAAA,KAAK,EAAC,OAAhD;AAAA,8CACE;AAAO,wBAAA,SAAS,EAAC,cAAjB;AAAA,+CACE;AAAA,kDACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kCADF,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kCAFF,eAGE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kCAHF,eAIE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kCAJF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,8BADF,eASE;AAAA,kCACGE;AADH;AAAA;AAAA;AAAA;AAAA,8BATF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,0BALF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF,qBADF;AAoCD;;AA/K+B;;AAmLlC,eAAeE,SAAf","sourcesContent":["import {\r\n  LoadingContainer\r\n} from '@drizzle/react-components';\r\nimport { DrizzleProvider } from '@drizzle/react-plugin';\r\nimport React, { Component } from \"react\";\r\nimport { Spinner } from 'react-bootstrap';\r\n// reactstrap components\r\nimport {\r\n  Button, Card, CardBody, CardHeader, CardTitle, Col, Row, Table\r\n} from \"reactstrap\";\r\nimport '../../node_modules/bootstrap/dist/css/bootstrap.min.css';\r\nimport Land from \"../artifacts/Land.json\";\r\nimport getWeb3 from \"../getWeb3\";\r\nimport \"../index.css\";\r\n\r\n\r\n\r\nconst drizzleOptions = {\r\n  contracts: [Land]\r\n}\r\n\r\n\r\nvar row = [];\r\nvar landOwner = [];\r\n\r\nclass Dashboard extends Component {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.state = {\r\n      LandInstance: undefined,\r\n      account: null,\r\n      web3: null,\r\n      count: 0,\r\n      requested: false,\r\n    }\r\n  }\r\n\r\n\r\n  makePayment = (seller_address, amount, land_id) => async () => {\r\n    // alert(amount);\r\n\r\n    amount = amount * 0.0000057;\r\n    alert(amount);\r\n    await this.state.LandInstance.methods.payment(\r\n      seller_address,\r\n      land_id\r\n    ).send({\r\n      from: this.state.account,\r\n      value: this.state.web3.utils.toWei(amount.toString(), \"ether\"),\r\n      gas: 2100000\r\n    }).then(response => {\r\n      this.props.history.push(\"#\");\r\n    });\r\n    //Reload\r\n    window.location.reload(false);\r\n\r\n  }\r\n\r\n  componentDidMount = async () => {\r\n    //For refreshing page only once\r\n    if (!window.location.hash) {\r\n      console.log(window.location.hash);\r\n      window.location = window.location + '#loaded';\r\n      window.location.reload();\r\n    }\r\n\r\n    try {\r\n      //Get network provider and web3 instance\r\n      const web3 = await getWeb3();\r\n\r\n      const accounts = await web3.eth.getAccounts();\r\n\r\n      const networkId = await web3.eth.net.getId();\r\n      const deployedNetwork = Land.networks[networkId];\r\n      const instance = new web3.eth.Contract(\r\n        Land.abi,\r\n        deployedNetwork && deployedNetwork.address,\r\n      );\r\n\r\n      this.setState({ LandInstance: instance, web3: web3, account: accounts[0] });\r\n\r\n      const currentAddress = await web3.currentProvider.selectedAddress;\r\n      console.log(currentAddress);\r\n      var registered = await this.state.LandInstance.methods.isBuyer(currentAddress).call();\r\n      console.log(registered);\r\n      this.setState({ registered: registered });\r\n      var count = await this.state.LandInstance.methods.getLandsCount().call();\r\n      count = parseInt(count);\r\n      console.log(typeof (count));\r\n      console.log(count);\r\n\r\n\r\n\r\n      var dict = {}\r\n      for (var i = 1; i < count + 1; i++) {\r\n        var address = await this.state.LandInstance.methods.getLandOwner(i).call();\r\n        dict[i] = address;\r\n      }\r\n\r\n      for ( i = 0; i < count; i++) {\r\n        var paid = await this.state.LandInstance.methods.isPaid(i + 1).call();\r\n        var price = await this.state.LandInstance.methods.getPrice(i + 1).call();\r\n        row.push(<tr><td>{i + 1}</td><td>{dict[i + 1]}</td><td>{price}</td>\r\n          <td>\r\n            <Button onClick={this.makePayment(dict[i + 1], price, i + 1)}\r\n              disabled={paid} className=\"btn btn-success\">\r\n              Make Payment\r\n            </Button>\r\n          </td>\r\n        </tr>)\r\n\r\n      }\r\n      console.log(row);\r\n\r\n\r\n\r\n\r\n    } catch (error) {\r\n      // Catch any errors for any of the above operations.\r\n      alert(\r\n        `Failed to load web3, accounts, or contract. Check console for details.`,\r\n      );\r\n      console.error(error);\r\n    }\r\n  };\r\n\r\n\r\n\r\n  render() {\r\n    if (!this.state.web3) {\r\n      return (\r\n        <div>\r\n          <div>\r\n            <h1>\r\n              <Spinner animation=\"border\" variant=\"primary\" />\r\n            </h1>\r\n          </div>\r\n\r\n        </div>\r\n      );\r\n    }\r\n\r\n    if (!this.state.registered) {\r\n      return (\r\n        <div className=\"content\">\r\n          <div>\r\n            <Row>\r\n              <Col xs=\"6\">\r\n                <Card className=\"card-chart\">\r\n                  <CardBody>\r\n                    <h1>\r\n                      You are not verified to view this page\r\n                    </h1>\r\n                  </CardBody>\r\n                </Card>\r\n              </Col>\r\n            </Row>\r\n          </div>\r\n\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <>\r\n        <div className=\"content\">\r\n          <DrizzleProvider options={drizzleOptions}>\r\n            <LoadingContainer>\r\n              <Row>\r\n                <Col lg=\"12\" md=\"12\">\r\n                  <Card>\r\n                    <CardHeader>\r\n                      <CardTitle tag=\"h4\">Payment for Lands<span className=\"duration\">â‚¹ 1 = 0.0000057 Ether</span></CardTitle>\r\n\r\n                    </CardHeader>\r\n                    <CardBody>\r\n                      <Table className=\"tablesorter\" responsive color=\"black\">\r\n                        <thead className=\"text-primary\">\r\n                          <tr>\r\n                            <th>#</th>\r\n                            <th>Land Owner</th>\r\n                            <th>Price ( in rupees )</th>\r\n                            <th>Make Payment</th>\r\n                          </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                          {row}\r\n                        </tbody>\r\n                      </Table>\r\n                    </CardBody>\r\n                  </Card>\r\n                </Col>\r\n              </Row>\r\n            </LoadingContainer>\r\n          </DrizzleProvider>\r\n        </div>\r\n      </>\r\n\r\n    );\r\n  }\r\n}\r\n\r\n\r\nexport default Dashboard;\r\n"]},"metadata":{},"sourceType":"module"}